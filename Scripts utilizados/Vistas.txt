
--VISTAS
--1
CREATE VIEW VISTA_PRODUCTOS_CATEGORIAS AS
SELECT 
    p.ID_PRODUCTO, 
    p.NOMBRE AS NOMBRE_PRODUCTO, 
    p.PRECIO, 
    p.STOCK, 
    c.NOMBRE_CATEGORIA
FROM 
    PRODUCTOS p, CATEGORIAS c
WHERE 
    p.ID_CATEGORIA = c.ID_CATEGORIA;
    

--2
CREATE VIEW VISTA_CLIENTES_COMPRAS AS
SELECT 
    c.ID_CLIENTE, 
    c.NOMBRE AS NOMBRE_CLIENTE, 
    v.ID_VENTA, 
    v.FECHA_VENTA, 
    v.TOTAL
FROM 
    CLIENTES c, VENTAS v
WHERE 
    c.ID_CLIENTE = v.ID_CLIENTE;


--3
CREATE VIEW VISTA_VENTAS_DETALLADAS AS
SELECT 
    v.ID_VENTA, 
    v.FECHA_VENTA, 
    v.TOTAL, 
    dv.ID_PRODUCTO, 
    dv.CANTIDAD, 
    dv.SUBTOTAL
FROM 
    VENTAS v, DETALLE_VENTAS dv
WHERE 
    v.ID_VENTA = dv.ID_VENTA;


--4
CREATE VIEW VISTA_EMPLEADOS_VENTAS AS
SELECT 
    e.ID_EMPLEADO, 
    e.NOMBRE AS NOMBRE_EMPLEADO, 
    v.ID_VENTA, 
    v.FECHA_VENTA, 
    v.TOTAL
FROM 
    EMPLEADOS e, VENTAS v
WHERE 
    e.ID_EMPLEADO = v.ID_EMPLEADO;
    
    
--5
CREATE VIEW VISTA_PROVEEDORES_COMPRAS AS
SELECT 
    p.ID_PROVEEDOR, 
    p.NOMBRE AS NOMBRE_PROVEEDOR, 
    c.ID_COMPRA, 
    c.FECHA_COMPRA, 
    c.TOTAL
FROM 
    PROVEEDORES p, COMPRAS c
WHERE 
    p.ID_PROVEEDOR = c.ID_PROVEEDOR;
    

--6
CREATE VIEW VISTA_PRODUCTOS_MAS_VENDIDOS AS
SELECT 
    p.ID_PRODUCTO, 
    p.NOMBRE AS NOMBRE_PRODUCTO, 
    SUM(dv.CANTIDAD) AS TOTAL_VENDIDOS
FROM 
    PRODUCTOS p, DETALLE_VENTAS dv
WHERE 
    p.ID_PRODUCTO = dv.ID_PRODUCTO
GROUP BY 
    p.ID_PRODUCTO, p.NOMBRE;
    

--7
CREATE VIEW VISTA_STOCK_BAJO AS
SELECT 
    p.ID_PRODUCTO, 
    p.NOMBRE AS NOMBRE_PRODUCTO, 
    p.STOCK
FROM 
    PRODUCTOS p
WHERE 
    p.STOCK < 30;


--8
CREATE VIEW VISTA_COMPRAS_RECIENTES AS
SELECT 
    c.ID_COMPRA, 
    c.FECHA_COMPRA, 
    c.TOTAL, 
    p.NOMBRE AS NOMBRE_PROVEEDOR
FROM 
    COMPRAS c, PROVEEDORES p
WHERE 
    c.ID_PROVEEDOR = p.ID_PROVEEDOR
AND 
    c.FECHA_COMPRA >= SYSDATE - 30;


--9
CREATE VIEW VISTA_CLIENTES_FRECUENTES AS
SELECT 
    c.ID_CLIENTE, 
    c.NOMBRE AS NOMBRE_CLIENTE, 
    COUNT(v.ID_VENTA) AS NUMERO_COMPRAS
FROM 
    CLIENTES c, VENTAS v
WHERE 
    c.ID_CLIENTE = v.ID_CLIENTE
GROUP BY 
    c.ID_CLIENTE, c.NOMBRE
HAVING 
    COUNT(v.ID_VENTA) > 1;
    
--10
CREATE VIEW VISTA_INGRESOS_TOTALES AS
SELECT 
    v.FECHA_VENTA, 
    SUM(v.TOTAL) AS INGRESOS
FROM 
    VENTAS v
GROUP BY 
    v.FECHA_VENTA
ORDER BY 
    v.FECHA_VENTA DESC;